
# Домашнее задание к занятию «Микросервисы: принципы»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

Рассмотрим несколько решений и их соответствие требованиям

|API Gateway|Маршрутизация|Проверка информации|Терминация HTTPS|
|-----------|-------------|-------------------|----------------|
|HAProxy|+|+|+|
|NGINX|+|+|+|
|AWS API Gateway|+|+|+|
|Yandex API Gateway|+|+|+|
|Tyk|+|+|+|
|Kong Gateway|+|+|+|

На рынке существует большое количество предложений, которые подходят под наши требования. Значит необходимо отталкиваться и от требований организации - должен ли работать api gateway в нашем контуре, какие критерии безопасности и отказоустойчивости должны быть обеспечены, есть ли у нас специалисты которые работали на хорошем уровне с рассматриваемыми вариантами, какие планы и задачи есть на будущее. 
- Если мы держим свою инфраструктуру в облаках, то целесообразно смотреть в сторону облачных решений и вариантов (aws, yandex).
- Если эта задача для нас новая и у нас нет штата специалистов тонко разбирающихся в выбранных вариантах, то можно выбрать более известные решения (nginx, haproxy).
- Если в нашей команде есть специалисты с хорошим опытом по данному направлению, то можно более узко определить задачи и выбрать подходящий вариант с заделом на будущее.

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

|Задача|Apache Kafka|RabbitMQ|Redis|ActiveMQ|Tarantool Queue|
|------|------------|--------|-----|--------|---------------|
|поддержка кластеризации для обеспечения надёжности|+|+/-|+|+|+|
|хранение сообщений на диске в процессе доставки|+|+|+/-|+|+/-|
|высокая скорость работы|+|+/-|+|+/-|+|
|поддержка различных форматов сообщений|+|+|+|+|+|
|разделение прав доступа к различным потокам сообщений|+|+|+|+|+|
|простота эксплуатации|-|+|+|+|+|

Исходя из поставленных требования нет возможности найти идеальное решение. Самыми популярными из рассматриваемых вариантов являются Kafka и RabbiMQ. 
- Kafka — это распределенная очередь с высокой пропускной способностью, созданная для длительного хранения больших объемов данных. Минусом становится сложность настройки и администрирования, если взять в расчет, что у нас есть специалист, то это будет хорошим выбором.
- RabbitMQ — давно известный, популярный брокер со множеством функций и возможностей, поддерживающих сложную маршрутизацию. Но по пропускной способности Rabbit значительно уступает Kafka.
- Redis - тоже может быть хорошим выбором, с высокой скоростью работы и простой эксплуатацией. Однако Redis не поддерживает хранение сообщений на диске по умолчанию.
